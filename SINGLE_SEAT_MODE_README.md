# 座位监控系统 - 单座位监控模式说明

本文件说明了座位监控系统的单座位监控模式功能及使用方法。

## 功能变更

系统现在支持以下新功能：

1. **单座位监控**：系统默认只监控一个座位区域
2. **交互式区域初始化**：用户可以通过鼠标点击来定义监控区域

## 如何使用

### 1. 启动程序

使用以下命令启动座位监控系统：

```bash
./start_monitor.sh
# 或
python main.py
```

### 2. 初始化监控区域

程序启动时，会询问是否使用现有监控区域：

- 输入 `y` 使用现有区域配置
- 输入 `n` 进行交互式区域定义

如果选择交互式区域定义：

1. 摄像头画面将显示在窗口中
2. 使用鼠标依次点击四个点来定义监控区域（建议按顺时针或逆时针顺序点击）
3. 每点击一个点，程序会显示已选择的点数
4. 完成四个点的选择后，按任意键继续
5. 新定义的区域将自动保存到配置文件中

### 3. 系统操作

- 程序会持续显示摄像头内容和监控区域
- 当检测到区域内有人时，区域边框会变为红色，并显示"有人"状态
- 按 `q` 键退出程序

## 配置说明

### 配置文件

配置文件 `config.json` 包含以下主要设置：

```json
{
  "camera": {
    "resolution": {"width": 1280, "height": 720},
    "framerate": 10,
    "rotation": 0
  },
  "detection": {
    "motion_threshold": 10000,
    "detection_interval": 0.1
  },
  "seats": [
    {
      "id": 1,
      "name": "监控区域",
      "region": [[200, 100], [1000, 100], [1000, 600], [200, 600]]
    }
  ],
  "data": {
    "save_interval": 60,
    "reports_directory": "reports",
    "data_directory": "data",
    "known_faces_directory": "known_faces"
  }
}
```

### 关键参数说明

- `motion_threshold`：检测是否有人的轮廓面积阈值，值越小越敏感
- `detection_interval`：检测间隔时间（秒）
- `seats[0].region`：监控区域的四个点坐标

## 数据记录

系统会自动记录：

- 座位占用状态变化
- 占用时长
- 生成每日报告

数据文件保存在 `data` 目录，报告保存在 `reports` 目录。

## 常见问题

### 1. 监控区域选择不准确

如果对已定义的区域不满意，可以在下次启动时选择重新定义区域。

### 2. 检测灵敏度调整

如果检测不够敏感或过于敏感，可以修改 `config.json` 中的 `motion_threshold` 参数：
- 增大值：降低灵敏度，减少误报
- 减小值：提高灵敏度，增加检测成功率

## 退出程序

- 在程序窗口中按 `q` 键退出
- 或使用 `Ctrl+C` 在终端中中断程序

程序退出时会自动保存当前状态并生成当日报告。