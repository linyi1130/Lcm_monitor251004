# 座位监控系统 - 简化版使用说明

根据您的需求，我们对程序进行了修改，实现了以下功能：

## 修改内容

1. **简化了人员检测逻辑**
   - 移除了复杂的人脸识别和学习功能
   - 保留并优化了基本的人体轮廓检测功能，可以检测到包括背影在内的人员
   - 不再需要预先加载已知人脸数据

2. **增强了摄像头预览功能**
   - 优化了窗口显示设置，使预览窗口自适应摄像头分辨率
   - 添加了帧获取失败的检查和处理逻辑
   - 增加了详细的调试信息输出
   - 加强了异常处理，确保程序稳定运行

3. **更新了配置文件**
   - 移除了不再使用的人脸识别相关配置

## 如何运行

1. 确保您已经正确设置了虚拟环境并安装了所有依赖：
   ```bash
   # 创建并配置虚拟环境
   ./setup_venv.sh
   
   # 修复libcamera模块访问问题（如果需要）
   ./fix_venv_libcamera.sh
   ```

2. 直接运行程序：
   ```bash
   # 通过启动脚本运行
   ./start_monitor.sh
   
   # 或者直接运行Python文件
   python main.py
   ```

## 功能说明

- 程序启动后，会立即显示摄像头捕获的实时画面
- 画面上会显示座位区域标记和占用状态
- 当检测到座位有人时，会在座位标记旁显示"有人"状态
- 按键盘上的'q'键可以退出程序

## 调试信息

程序运行时会输出以下调试信息：
- 摄像头初始化和启动状态
- 当前运行模式（简化版）
- 座位占用和释放事件
- 错误和异常信息（如有）

## 常见问题排查

如果遇到画面全黑或无法显示摄像头内容的问题，请尝试以下步骤：

1. 确保摄像头模块正确连接并被系统识别：
   ```bash
   libcamera-hello --list-cameras
   ```

2. 检查虚拟环境是否正确配置了libcamera访问权限：
   ```bash
   ./fix_venv_libcamera.sh
   ```

3. 确认所有依赖已正确安装：
   ```bash
   source seat_monitor_venv/bin/activate
   pip install -r requirements.txt
   ```

4. 尝试调整config.json中的摄像头分辨率设置

如果问题仍然存在，请查看程序输出的错误信息，这些信息将帮助您进一步排查问题。